<html>
	<head>
		<link rel="stylesheet" type="text/css" href="../css/mapview.css">
	</head>
	<body>
		<h2>RouteView</h2>
		<img src="../png/routeview.png" />

		<p>This viewer creates and edits nodes on the Map that aLiens and civilians use for spawning and patrolling, and that XCOM agents use for spawning (usually in base defense missions). The actual mechanics that the XCOM engine employs is beyond the purview of this document.</p>

		<p>Left-click on a tile selects that tile. Left-click on a route-node selects that route-node for editing. Left-click on a route-node and drag it to a tile that does not have a node to move the node to that location.</p>

		<p>Right-click on a tile without a node creates a node on that tile. It can also do automatic node-linking (see connection options below).</p>

		<p>Using the mousewheel when the panel is focused raises and lowers the editing level.</p>

		<p>The color-blobs that appear on the Map are simplistic representations of the various parts that have been placed on tiles. Floor parts are not represented however.</p>

		<p>Route nodes are presented in different colors depending on their currently assigned node rank. Colored lines are drawn between linked nodes. A selected node and its link-lines appear in yet another color. Colors can be set in Options, as with the other viewers.</p>

		<p>An overlay appears with tile position and node data as the mouse moves over the Map. Also, two small vertical bars are shown at each node - the left bar (red) presents the spawn weight and the right bar (blue) presents the patrol priority. The info-overlay and weight/priority meters can be toggled on and off in Options.</p>

		<br>
		<h3>Tile data</h3>
		<p>This section displays the currently selected tile's position along with the ID of the node at that position if one exists. It also shows the position that the mouse-cursor hovers over as well as the ID of a node at that position if one exists. If a node-link or the Og button is mouseovered the position and ID of the respective node is displayed.</p>

		<br>
		<h3>Node data</h3>
		<p>
&nbsp;&nbsp;&nbsp;&nbsp;Unit Type - aLien units must have this characteristic to patrol the node.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Node Rank - the faction or, if aLien, the rank of units that may spawn at the node.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Spawn Weight - the weight given to spawn at the node (note that "0" will disallow spawns).<br>
&nbsp;&nbsp;&nbsp;&nbsp;Patrol Priority - the priority that aLien units will give this node when patrolling nearby (note that even "0" is valid for patrolling).<br>
&nbsp;&nbsp;&nbsp;&nbsp;Base Attack - this acts as a lure for aLien units. If and when they reach a node with a non-zero value, they will start shooting up XCOM Base facilities. This is relevant only for XCOM Base defense missions.</p>

		<br>
		<h3>Link data</h3>
		<p>
&nbsp;&nbsp;&nbsp;&nbsp;Link1..5 - each node has up to five destination nodes. The first field specifies the destination's ID or a compass point. The second field specifies the characteristic that an aLien unit must have to use the link. The third field is the distance between the origin and destination nodes, and is calculated automatically by MapView. It is not used by XCOM mechanics and is purely informational. An up arrow appears after the entry if the link goes to a higher level on the Map, or a down arrow appears if the entry goes to a lower level on the Map.</p>

		<p>Along the right side of the Link data is a column of Go buttons. A button is enabled if it has a regular node as the link's destination. When the mouse is hovered over an enabled button, the link's destination is highlighted along with its link-line. Clicking an enabled Go button selects that link's destination node. To the right of that column is the Og button, which is a Go button in reverse. It can be used as a back-button but with a difference, in that if a Go button has been clicked then the source node can be returned to even if other nodes have been selected inbetween clicking a Go button and the Og button.</p>

		<p>If a node is detected as linked to an Out of Bounds node the "Link" text will appear in red. Clicking the Go button of such a link will open a dialog that allows the Out of Bounds destination node to be deleted.</p>

		<br>
		<h3>Node editor</h3>
		<p>
&nbsp;&nbsp;&nbsp;&nbsp;Cut [Ctrl+X] - deletes the currently selected node and copies its Patrol and Spawn data to the Windows clipboard.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Copy [Ctrl+C] - copies the currently selected node's Patrol and Spawn data to the Windows clipboard.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Paste [Ctrl+V] - pastes Patrol and Spawn data from the Windows clipboard to the currently selected node.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Delete [Delete] - deletes the currently selected node.</p>

		<br>
		<h3>Node Rank colors</h3>
		<p>Left-click on a colored panel to highlight nodes of that rank as per the Highlights menu (see below). Depress [Ctrl] to add or subtract a rank's highlight.</p>

		<p>Note that [Ctrl+S] can be used to save the Routes when the center panel has focus. A "save" button will be enabled in the lower right corner of the data area if the Routefile is changed but has not been saved.</p>

		<p>The "tally" button (to the right of the "og" button) opens a dialog that displays spawn information for the current Routes as well as in the current Map's category.</p>

		<p>[F5] toggles TileView.<br>
		[F6] toggles TopView.<br>
		[F7] closes RouteView or toggles RouteView if TopRouteView is focused.<br>
		[F8] closes TopRouteView or toggles TopRouteView if RouteView is focused.</p>

		<p>[Ctrl+F5] through [Ctrl+F8] focuses the respective viewer.<br>
		[Shift+F5] through [Shift+F8] focuses MainView.</p>

		<p>[F11] minimizes all viewers.<br>
		[F12] restores all viewers.</p>

		<p>[Esc] focuses the panel. That is, it defocuses any other control. It can also deselect a selected node but leave its tile selected.</p>

		<p>[Ctrl+Q] quits MapView II</p>

		<br>
		<h3>Keyboard navigation</h3>

		<p>The numeric keypad - that is, the arrow keys and [Home], [End], [PageUp], [PageDown] - select the tile in the chosen direction. The add and subtract keys on the numeric keypad lower and raise the current level respectively.</p>

		<p>When a route-node is selected, holding [Shift] while navigating with the keyboard will drag the node to a new location.</p>

		<p>[Enter] creates a node at the current location if a node doesn't exist on the tile, or if a node does exist at the current location it will be selected. Note that selecting a tile on the currently displayed level that has a node will select that node automatically; however, selecting a tile that has a node will not automatically select the node when navigating from a different level. This behavior also happens when changing levels with the mousewheel - the reason for this is to better see the x/y relation of nodes that link to different levels.</p>

		<br>
		<h3>File menu</h3>

		<p>Export ... - saves a copy of the current routes to a file that can then be imported as the routes for a different Map.</p>
		<p>Import ... - implements the nodes of any .RMP file as the nodes for the currently displayed Map. Note that this will delete all current nodes on the Map and replace them with those in the imported Routefile.</p>

		<br>
		<h3>Edit menu</h3>

		<p>node up 1 level - moves a selected node up 1 level if possible.</p>
		<p>node down 1 level - moves a selected node down 1 level if possible.</p>
		<p>clear current Link data ... - resets all five link-slots of the selected node to NotUsed. A confirmation dialog is shown.</p>
		<p>zero all unittypes ... - sets all routenodes to unittype:Any. A confirmation dialog is shown.</p>
		<p>zero all noderanks ... - sets all routenodes to noderank:Civilian/Scout. A confirmation dialog is shown.</p>
		<p>zero all spawnweights ... - sets all routenodes to spawnweight:None. A confirmation dialog is shown.</p>
		<p>zero all patrolpriorities ... - sets all routenodes to patrolpriority:LoLo. A confirmation dialog is shown.</p>
		<p>zero all baseattacks ... - sets all routenodes to baseattack:None. A confirmation dialog is shown.</p>
		<p>update all Link distances - a utility that ensures that all displayed link distances are correct. A confirmation dialog is <b>not</b> shown.</p>

		<br>
		<h3>Test menu</h3>

		<p>test node positions - tests for nodes that are outside the Map's boundaries.</p>
		<p>test node ranks - tests for invalid node ranks.</p>

		<br>
		<h3>Highlights menu</h3>

		<p>Spawn nodes only [Ctrl+h] - ghosts nodes with spawnweight:None so that only nodes with a weight are left colored. The center panel must be focused for the hotkey to work. The ghost-color can be chosen in Options.</p>
		<p>NodeRank* [0..8] - ghosts all nodes that do not have the chosen noderank so that only nodes of that rank are left colored. The center panel must be focused for the shortcuts to work. The ghost-color can be chosen in Options. Depress [Ctrl] to add or subtract a highlight, but note that the shortcuts do not respect the [Ctrl] key.</p>
		<p>clear Rank highlights - what it says on the tin but does not affect the state of highlighted Spawn nodes</p>

		<br>
		<h3>Connection options</h3>

		<p>The menubar along the top of the panel has buttons representing three connection-types.<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;DontConnect - no automatic node-linking is performed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;OneWayConnect - when a node is selected and another node is then either created or right-clicked, a patrol-route is automatically linked from the first node to the second node, provided that a link-slot is available.<br>
&nbsp;&nbsp;&nbsp;&nbsp;TwoWayConnect - when a node is selected and another node is then either created or right-clicked, a patrol-route is automatically linked both ways between the nodes, provided that link-slots are available.</p>

		<br>
		<h3>x2 magnifier</h3>

		<p>Enabling the x2 magnifier renders the grid at twice its normal scale. Navigating around the grid is done with [Ctrl]+LMB, which centers the grid on a clicked point.</p>

		<br>
		<h3>Goto box</h3>

		<p>A valid node ID can be typed into the texbox and that node will be focused when [Enter] is pressed. The up/down arrows on either side of the box will increment or decrement the currently selected node ID respectively; note that the value wraps after the highest or lowest ID.</p>

		<br>
		<p>Options [Ctrl+O] - opens and closes the Options for RouteView. Descriptions for the entries appear at the bottom of that window.</p>
		<br>
	</body>
</html>
