<html>
	<head>
		<link rel="stylesheet" type="text/css" href="../css/mapview.css">
	</head>

	<body>
		<h2>McdView</h2>
		<img src="../png/mcdview.png" />

		<p>McdView is an MCD (MapControlData) editor for XCOM.</p>

		<p>McdView can create, open, edit, and save MCD files. An MCD file - or recordset - is a collection of data - records - denoting the characteristics of tileparts. A tilepart is the basic building block for the terrain of every XCOM battlefield. Each record in the collection is a tilepart and the 62 integer fields of each part are called a record.</p>

		<p>IMPORTANT: ScanG and LoFT icons for UFO and TFTD are different. So UFO and/or TFTD resources have to be set in MapView II's Configurator basepath for ScanG and LoFT icons to appear in McdView. The respective resources that should be used to draw the icons can then be selected under the Palette menu: UFO or TFTD. Note that McdView is still functional without ScanG or LoFT resources but the ScanG and LoFT values will no longer be safely capped at the number of entries in their respective resource files.</p>

		<p>Also note that McdView can be used to edit an MCD file without requiring its corresponding terrain sprites (PCK + TAB files). But sprite values will no longer be safely capped at the number of entries in those rogue terrain files.</p>

		<p>The top panel displays three rows of sprites. The first row displays the first sprite of each tilepart in the collection; the second row displays the first sprite of that part's Death part; and the third row displays the first sprite of that part's Alternate part. The row of numbers beneath the first row of sprites is a 0-based ID of the tileparts in a collection.</p>

		<p>Left-click selects a part. The left/right/up/down arrows, Home/End, and PageUp/Down can also be used to navigate through a collection. The Spacebar can be used to select the first part in the collection if there is <b>not</b> a part selected; if a part is already selected it selects the next part in the collection. Backspace selects the previous part in the collection.</p>

		<p>A note on selections. There is only ever 1 truly selected part; all integer fields that are displayed will belong to that part. Any other parts that are also selected are considered as sub-selected and their IDs in the Record Collection panel ought appear in a lighter hue to indicate their sub-status. The actual color of selected parts depends on your system settings ...</p>

		<p>Ctrl and Shift can be used to modify the current selection. Ctrl+LMB toggles a part's selected status unless it's the only selected part, in which case it does nothing. Shift+LMB selects a range of parts between the currently selected part and the part that is clicked; it can also toggle the currently selected part's selected status, similar to Ctrl but unlike Ctrl it can be used to deselect an only selected part also.</p>

		<p>Ctrl and Shift work differently when using the keyboard to navigate a collection. Ctrl selects parts that are navigated over and Shift deselects parts.</p>

		<p>Right-click opens a contextmenu of operations that can be performed on the currently selected part(s). Note that right-click does <b>not</b> select a part.<br><br>
&nbsp;&nbsp;&nbsp;&nbsp;add [d] - adds a blank record after the currently selected part. Adds a blank record at the beginning of the collection if there is not a selected part.<br>
&nbsp;&nbsp;&nbsp;&nbsp;add range ... [Ctrl+d] - opens a popup asking how many blank records to add after the currently selected part. The blank records will be added at the beginning of the collection if there is not a selected part.<br>
&nbsp;&nbsp;&nbsp;&nbsp;cut [Ctrl+x] - cuts the currently selected part or range of selected parts if applicable.<br>
&nbsp;&nbsp;&nbsp;&nbsp;copy [Ctrl+c] - copies the currently selected part or range of selected parts if applicable.<br>
&nbsp;&nbsp;&nbsp;&nbsp;insert after [Ctrl+v] - pastes any cut or copied records after the currently selected part. Such records will be pasted at the beginning of the collection if there is not a selected part. Note that records can be cut/copied from one record collection and inserted into a different collection after either opening or creating another collection.<br>
&nbsp;&nbsp;&nbsp;&nbsp;delete [Delete] - deletes the currently selected part or range of selected parts if applicable.<br>
&nbsp;&nbsp;&nbsp;&nbsp;append file ... - not done yet.<br>
&nbsp;&nbsp;&nbsp;&nbsp;swap left [-] - swaps the currently selected part with the part to its left.<br>
&nbsp;&nbsp;&nbsp;&nbsp;swap right [+] - swaps the currently selected part with the part to its right.<br>
&nbsp;&nbsp;&nbsp;&nbsp;select all [Ctrl+a] - selects all parts in the collection.<br>
&nbsp;&nbsp;&nbsp;&nbsp;deselect all [Esc] - deselects any selected parts in the collection as long as an integer field is not currently focused.</p>

		<p>Beneath the Record Collection panel is a panel that displays the 8 sprites that XCOM usually animates through continuously to rendering the part onscreen. Left-clicking an animation sprite brings up a spriteset viewer; clicking a sprite in the spriteset viewer selects that sprite for the phase that was clicked to open the viewer. Right-clicking a sprite either in the panel or the spriteset viewer brings up an option to assign the clicked sprite to all sprite-phases.</p>

		<p>On the lower right is a list of LoFTs (Line of Fire Templates). There are 12 LoFTs stacked vertically to model a 3D representation of a part; each layer is doubled to fill the 24-voxel height of a tile on the battlefield. Left-clicking an icon brings up a LoFT icon viewer; clicking an icon in the viewer selects that template for the respective LoFT layer. Right-clicking an icon either in the panel or the icon viewer brings up an option to assign the clicked template to all layers.</p>

		<p>The IsoLoFT panel is a (roughly) isometric projection of the LoFT entries of the currently selected part. The vertical trackbar to the left of the panel will slice down through the LoFTs for a better understanding of a part's 3D voxel-model. Note that the value of the trackbar is irrelevant to XCOM and its setting is not saved.</p>

		<p>Clicking the IsoLoFT panel focuses its trackbar for scrolling with the mousewheel. Right-clicking will additionally reset the trackbar to display all LoFTs of the tilepart.</p>

		<p>[s] - toggles the STRICT setting. Values that XCOM is not expected to use properly cannot be entered in any integer field when STRICT is on. I suggest leaving it on unless you really know what you're doing - or unless I goofed in which case it's a bug and should be reported.</p>

		<p>SpriteShade is simply a gamma-adjustment that's internal to McdView. It is <b>not</b> palette-based, has nothing to do with XCOM itself, and is not saved.</p>

		<p>description - shows general information about any mouse-overed and/or selected field.</p>

		<p>The statusbar along the bottom shows the value of a currently selected field along with its interpretation if applicable.</p>

		<p>Integer Fields - All fields will be blank until a part is selected. Other than that they should never be blank, a value cannot be deleted - you might have to select all or part of the text in the field and type in a different value to change it. Fields accept integer values only. If the STRICT setting is enabled then accepted values shall be limited to those that XCOM generally expects; if STRICT is unchecked then the values are bounded only by their type: you're basically dealing with an unsigned byte: 0..255 (the ScanG field is an unsigned short: 0..65535; the TerrainOffset field is a signed byte: -128..127; and several other fields are simple booleans: 0 or 1).</p>

		<p>The [+/-] keys on the numeric keypad can be used to increment and decrement a value within its limits when its field is focused for editing.</p>

		<p>[Esc] or [Enter] will unfocus a field and focus the Record Collection panel for navigation, as will clicking almost anywhere on the background of the app.</p>

		<p>Clicking on the IsoLoFT panel focuses its vertical trackbar, as does returning from the LoFTs viewer.</p>

		<br>
		<h3>File menu</h3>

		<p>Create MCD file ... [Ctrl+r] - creates a blank record collection. Confirmation is required if a collection is already loaded and its values were changed.</p>
		<p>Save MCD file and spriteset [Ctrl+m] - saves the current record collection as well as its spriteset</p>
		<p>Open MCD file ... [Ctrl+o] - opens a record collection. Confirmation is required if a collection is already loaded and its values were changed.</p>
		<p>Save MCD file [Ctrl+s] - saves the current record collection.</p>
		<p>Save MCD file as ... [Ctrl+e] - saves the current record collection to disk as a different file.</p>
		<p>Reload MCD file [Ctrl+l] - reloads the current record collection from disk. <b>There is no confirmation for reloads.</b></p>
		<p>Save spriteset [Ctrl+i] - writes or rewrites the terrain's PCK + TAB files.</p>
		<p>Quit [Ctrl+q] - exits the application. Confirmation is required if a collection is loaded and its values were changed.</p>

		<br>
		<h3>Palette menu</h3>

		<p>UFO [Ctrl+u] - displays sprites with the standard UFO battle-palette. ScanG and LoFT icons will <b>not</b> be displayed if UFO resources are not configured in MapView II's basepath. The UFO palette is selected by default.</p>
		<p>TFTD [Ctrl+t] - displays sprites with the standard TFTD battle-palette. ScanG and LoFT icons will <b>not</b> be displayed if TFTD resources are not configured in MapView II's basepath.</p>

		<br>
		<h3>Edit menu</h3>

		<p>zero this part's values [Ctrl+0] - zeros all fields of the currently selected tilepart.</p>
		<p>check STRICT values [Ctrl+k] - runs a test of the values of the currently selected tilepart against a range of values that are generally suitable for XCOM. Also runs tests for internal consistency. The results are displayed in a dialog.</p>

		<br>
		<h3>Help menu</h3>

		<p>Help [Ctrl+h] - shows this CHM helpfile.</p>
		<p>About [Ctrl+b] - version info.</p>
		<br>
		</body>
</html>
